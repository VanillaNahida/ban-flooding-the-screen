# 刷屏禁言插件

AstrBot 刷屏禁言插件，检测到刷屏时自动禁言，屡犯者将被踢出群。

## 功能特性

- 自动检测群聊中的刷屏行为
- 检测到刷屏后自动禁言用户
- 支持累计触发次数统计
- 屡犯者自动踢出群
- 可自定义各项参数
- 支持群级别独立配置
- 管理员命令控制

## 管理员命令

以下命令仅限群主和管理员使用，如果机器人没有管理员权限，会返回"bot权限不足，需要管理员权限"：

| 命令 | 说明 | 参数/示例 |
|------|------|-----------|
| `/开启刷屏禁言` | 在当前群开启刷屏检测功能 | - |
| `/关闭刷屏禁言` | 在当前群关闭刷屏检测功能 | - |
| `/设置刷屏禁言时间 <时间>` | 设置禁言时长 | 支持格式：<br>- `1分`、`1分钟`、`1m` - 1分钟<br>- `1小时`、`1h` - 60分钟<br>- `1天`、`1d` - 1440分钟<br>- 纯数字（如 `10`）- 视为分钟<br><br>示例：<br>- `/设置刷屏禁言时间 10分钟`<br>- `/设置刷屏禁言时间 1小时`<br>- `/设置刷屏禁言时间 2d` |
| `/开启刷屏踢人` | 在当前群开启屡犯踢人功能 | - |
| `/关闭刷屏踢人` | 在当前群关闭屡犯踢人功能 | - |
| `/设置刷屏踢人次数 <次数>` | 设置累计多少次后踢出 | 示例：`/设置刷屏踢人次数 5` - 累计触发5次后踢出 |
| `/重置刷屏次数 @用户` | 重置指定用户的刷屏累计次数 | 示例：`/重置刷屏次数 @用户名` - 清除该用户的累计触发次数 |

## 配置说明

### 启用群白名单 (`enabled_groups`)
- 类型：列表
- 默认值：`[]`
- 说明：填入需要开启刷屏检测的群号（纯数字）。如果留空，则对机器人所在的所有群生效。
- 注意：此配置已弃用，请使用命令 `/开启刷屏禁言` 在群内开启功能

### 检测周期 (`detection_period`)
- 类型：整数
- 默认值：`4`
- 说明：在此时间内发送的消息数量达到阈值即触发禁言。单位：秒。

### 消息条数 (`message_threshold`)
- 类型：整数
- 默认值：`4`
- 说明：在检测周期内发送的消息数量达到此数值即触发禁言。

### 禁言时长 (`mute_time`)
- 类型：整数
- 默认值：`10`
- 说明：触发刷屏时的禁言时长。单位：分钟。
- 注意：此为全局默认值，可通过命令 `/设置刷屏禁言时间` 在群内单独设置

### 禁言提示语 (`mute_message`)
- 类型：字符串
- 默认值：`"检测到刷屏，已自动禁言，如有异议请联系管理员"`
- 说明：触发禁言后发送的消息。留空则不发送消息。
- 可用变量：`{at_user}`（@用户）、`{nickname}`（用户昵称）、`{mute_time}`（禁言时长）

### 启用屡犯踢群 (`enable_kick_repeat_offender`)
- 类型：布尔值
- 默认值：`true`
- 说明：是否启用屡犯踢群功能。启用后，当用户累计达到阈值次数时将被踢出群。
- 注意：此为全局默认值，可通过命令 `/开启刷屏踢人` 在群内单独设置

### 踢群阈值 (`kick_threshold`)
- 类型：整数
- 默认值：`5`
- 说明：用户累计触发禁言多少次后将被踢出群。
- 注意：此为全局默认值，可通过命令 `/设置刷屏踢人次数` 在群内单独设置

### 踢群提示语 (`kick_message`)
- 类型：字符串
- 默认值：`"{at_user} 你已累计触发刷屏禁言 {count} 次，已被请出本群。"`
- 说明：用户被踢出群时发送的消息。
- 可用变量：`{at_user}`（@用户）、`{count}`（累计次数）

### 踢群延迟时间 (`kick_delay`)
- 类型：整数
- 默认值：`3`
- 说明：踢人前的延迟时间（秒）。在发送踢人提示后等待指定时间再执行踢人操作。

## 权限要求

机器人需要在群中拥有管理员或群主权限才能执行禁言和踢人操作。
管理员命令仅限群主和管理员使用。

## 注意事项
- 累计触发次数使用持久化存储，重启后仍然保留
- 每个群可以独立配置是否启用刷屏检测、禁言时间和踢人次数
- 使用命令配置的设置会保存到配置文件中，重载插件生效
- 触发刷屏禁言时会@刷屏用户，并提示累计次数（如果启用了踢人功能）

## 支持

[帮助文档](https://astrbot.app)
